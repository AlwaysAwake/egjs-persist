/*!
 * Copyright (c) 2017 NAVER Corp.
 * @egjs/persist project is licensed under the MIT license
 * 
 * @egjs/persist JavaScript library
 * 
 * 
 * @version 2.0.0-rc2
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("Persist",[],t):"object"==typeof exports?exports.Persist=t():(e.eg=e.eg||{},e.eg.Persist=t())}(this,function(){return function(e){function __webpack_require__(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,__webpack_require__),o.l=!0,o.exports}var t={};return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.i=function(e){return e},__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=4)}([function(e,t,r){"use strict";t.__esModule=!0;var o="undefined"!=typeof window&&window||{};t.window=o;t.console=o.console,t.document=o.document,t.history=o.history,t.localStorage=o.localStorage,t.location=o.location,t.sessionStorage=o.sessionStorage,t.navigator=o.navigator,t.JSON=o.JSON,t.RegExp=o.RegExp,t.parseFloat=o.parseFloat,t.performance=o.performance},function(e,t,r){"use strict";function isBackForwardNavigated(){return o.performance.navigation.type===a}t.__esModule=!0;var o=r(0),n=o.navigator.userAgent,a=o.performance.navigation.TYPE_BACK_FORWARD||2,i=function(){var e=new o.RegExp("iPhone|iPad","i").test(n),t=new o.RegExp("Mac","i").test(n)&&!new o.RegExp("Chrome","i").test(n)&&new o.RegExp("Apple","i").test(n),r=new o.RegExp("Android ","i").test(n),a=new o.RegExp("wv; |inapp;","i").test(n),i=r?(0,o.parseFloat)(new o.RegExp("(Android)\\s([\\d_\\.]+|\\d_0)","i").exec(n)[2]):void 0;return!(e||t||r&&(i<=4.3&&a||i<3))}();t.default={isBackForwardNavigated:isBackForwardNavigated,isNeeded:i},e.exports=t.default},function(e,t,r){"use strict";function Persist(e,t){if(!(this instanceof Persist))return"string"!=typeof e?void i.console.warn("first param must be a string!"):((t||2===arguments.length)&&n.default.setStateByKey(e,t),n.default.getStateByKey(e));this.key=e}function setRec(e,t,r){var o=e;o||(o=isNaN(t[0])?{}:[]);var n=t.shift();return 0===t.length?(o instanceof Array&&isNaN(n)&&i.console.warn("Don't use key string on array"),o[n]=r,o):(o[n]=setRec(o[n],t,r),o)}t.__esModule=!0;var o=r(5),n=function(e){return e&&e.__esModule?e:{"default":e}}(o),a=r(1),i=r(0);Persist.prototype.get=function(e){var t=n.default.getStateByKey(this.key);if(0===e.length)return t;for(var r=e.split("."),o=t,a=!0,i=0;i<r.length;i++){if(!o){a=!1;break}o=o[r[i]]}return a&&o?o:null},Persist.prototype.set=function(e,t){var r=n.default.getStateByKey(this.key);return 0===e.length?n.default.setStateByKey(this.key,t):n.default.setStateByKey(this.key,setRec(r,e.split("."),t)),this},Persist.isNeeded=function(){return a.isNeeded},t.default=Persist,e.exports=t.default},function(e,t,r){"use strict";t.__esModule=!0;t.default="___persist___",e.exports=t.default},function(e,t,r){"use strict";var o=r(2),n=function(e){return e&&e.__esModule?e:{"default":e}}(o);n.default.VERSION="2.0.0-rc2",e.exports=n.default},function(t,r,o){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function isStorageAvailable(e){if(e){var t="__tmp__"+l.default;try{return e.setItem(t,l.default),e.getItem(t)===l.default}catch(e){return!1}}}function warnInvalidStorageValue(){console.warn("window.history or session/localStorage has no valid format data to be handled in persist.")}function getStorageKey(){return f?a.location.href+l.default:void 0}function getStorage(){return f}function getState(){var e=void 0,t=a.location.href+l.default,r=void 0;if(f?r=f.getItem(t):a.history.state&&("object"!==n(a.history.state)?r=a.history.state[t]:warnInvalidStorageValue()),null===r)return{};var o="string"==typeof r&&r.length>0&&"null"!==r;try{e=a.JSON.parse(r);var i=!("object"!==(void 0===e?"undefined":n(e))||e instanceof Array);if(!o||!i)throw new Error}catch(t){warnInvalidStorageValue(),e={}}return e}function getStateByKey(e){if(c||f){var t=getState()[e];return"null"!==t&&void 0!==t||(t=null),t}}function setState(t){var r=a.location.href+l.default;if(f)t?f.setItem(r,a.JSON.stringify(t)):f.removeItem(r);else try{var o=a.history.state;"object"===(void 0===o?"undefined":n(o))?(o[r]=a.JSON.stringify(t),a.history.replaceState(o,document.title,a.location.href)):console.warn(e.message)}catch(e){console.warn(e.message)}t?a.window[l.default]=!0:delete a.window[l.default]}function setStateByKey(e,t){if(c||f){var r=getState();r[e]=t,setState(r)}}function reset(){setState(null)}r.__esModule=!0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=o(0),i=o(1),s=_interopRequireDefault(i),u=o(3),l=_interopRequireDefault(u),c="replaceState"in a.history&&"state"in a.history,f=function(){var e=void 0;return isStorageAvailable(a.sessionStorage)?e=a.sessionStorage:isStorageAvailable(a.localStorage)&&(e=a.localStorage),e}();!s.default.isBackForwardNavigated()&&reset(),r.default={reset:reset,setStateByKey:setStateByKey,getStateByKey:getStateByKey,getStorageKey:getStorageKey,getStorage:getStorage},t.exports=r.default}])});